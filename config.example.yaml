# CompanionBot 설정
# 이 파일을 config.yaml로 복사하고 수정하세요.
# 설정하지 않은 값은 기본값 사용

# ============================================
# 모델 설정
# ============================================
model:
  # 기본 모델: opus, sonnet, haiku
  default: opus
  # thinking 레벨: off, low, medium, high
  thinking: medium

# ============================================
# 토큰/컨텍스트 설정
# ============================================
tokens:
  # Claude 최대 컨텍스트 (기본: 200000)
  maxContext: 200000
  # 히스토리 토큰 한도 (기본: 80000)
  maxHistory: 80000
  # 자동 요약 시작 토큰 (기본: 50000)
  summaryThreshold: 50000
  # 핀 맥락 최대 토큰 (기본: 10000)
  maxPinned: 10000
  # 자동 압축 시작 비율 (기본: 0.50 = 50%)
  compactionThreshold: 0.50
  # compact 스킵 기준 토큰 (기본: 5000)
  compactMinTokens: 5000

# ============================================
# 세션 설정
# ============================================
session:
  # 최대 동시 세션 수 (기본: 100)
  maxSessions: 100
  # 세션 TTL - 시간 (기본: 24)
  ttlHours: 24
  # 메모리에 로드할 최대 히스토리 (기본: 50)
  maxHistoryLoad: 50

# ============================================
# 메시지 설정
# ============================================
messages:
  # 트리밍 시 최소 유지 메시지 수 (기본: 6)
  minRecent: 6
  # compact 시 유지 메시지 수 (기본: 4)
  keepOnCompact: 4
  # 최대 요약 청크 수 (기본: 3)
  maxSummaryChunks: 3
  # 검색 기본 결과 수 (기본: 10)
  searchLimit: 10
  # 히스토리 로드 limit (기본: 100)
  historyLoadLimit: 100

# ============================================
# 메모리/벡터 설정
# ============================================
memory:
  # 벡터 캐시 TTL - 분 (기본: 5)
  cacheTtlMinutes: 5
  # 최소 청크 길이 (기본: 20)
  minChunkLength: 20
  # 최대 청크 길이 (기본: 500)
  maxChunkLength: 500
  # 로드할 최근 메모리 일수 (기본: 30)
  recentDays: 30
  # 벡터 검색 topK (기본: 5)
  searchTopK: 5
  # 최소 유사도 점수 (기본: 0.3)
  minSimilarity: 0.3
  # /memory 표시 일수 (기본: 7)
  displayDays: 7
  # /memory 최대 표시 길이 (기본: 2000)
  maxDisplayLength: 2000

# ============================================
# 텔레그램 설정
# ============================================
telegram:
  # 허용된 chatId 목록 (빈 배열이면 모든 사용자 허용)
  # 사내 배포 시 반드시 설정하세요
  allowedChatIds: []
  # 메시지 최대 길이 (기본: 4096)
  maxMessageLength: 4096
  # 최대 이미지 크기 MB (기본: 10)
  maxImageSizeMb: 10
  # URL 처리 최대 개수 (기본: 3)
  maxUrlFetch: 3
  # 캘린더 미리보기 이벤트 수 (기본: 3)
  calendarPreviewCount: 3
  # Typing 갱신 간격 ms (기본: 4000)
  typingRefreshMs: 4000

# ============================================
# API 설정
# ============================================
api:
  # 타임아웃 ms (기본: 120000 = 2분)
  timeoutMs: 120000
  # 최대 재시도 횟수 (기본: 3)
  maxRetries: 3
  # 초기 재시도 대기 ms (기본: 1000)
  initialRetryDelayMs: 1000
  # 최대 재시도 대기 ms (기본: 30000)
  maxRetryDelayMs: 30000
  # 재시도 백오프 배수 (기본: 2)
  backoffMultiplier: 2

# ============================================
# 검색 설정
# ============================================
search:
  # 전체 검색 타임아웃 ms (기본: 5000)
  timeoutMs: 5000
  # 임베딩 생성 타임아웃 ms (기본: 3000)
  embedTimeoutMs: 3000

# ============================================
# 보안 설정
# ============================================
security:
  # 리셋 토큰 만료 ms (기본: 60000 = 1분)
  resetTokenTtlMs: 60000

# ============================================
# PKM 설정 (문서 관리)
# ============================================
pkm:
  # PKM 기능 활성화 (기본: false)
  enabled: false
  # PKM 루트 경로 (기본: ~/.companionbot/pkm)
  root: "~/.companionbot/pkm"
  classify:
    # AI 분류 배치 크기 (기본: 10)
    batchSize: 10
    # 1단계→2단계 넘어가는 신뢰도 기준 (기본: 0.8)
    confidenceThreshold: 0.8
    # 파일 감시 디바운스 ms (기본: 2000)
    watcherDebounceMs: 2000
